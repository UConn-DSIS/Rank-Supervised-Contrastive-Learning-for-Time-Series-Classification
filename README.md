# RankSCL
This is the official repository of Rank Supervised Contrastive Learning for Time Series Classification, which was published in ICDM 2024 [https://arxiv.org/abs/2401.18057](https://arxiv.org/abs/2401.18057). We will keep maintaining this repository to faciliate the development of continual graph learning, and we appreciate any comment on improving our RankSCL! 
```
@misc{ren2024ranksupervisedcontrastivelearning,
      title={Rank Supervised Contrastive Learning for Time Series Classification}, 
      author={Qianying Ren and Dongsheng Luo and Dongjin Song},
      year={2024},
      eprint={2401.18057},
      archivePrefix={arXiv},
      primaryClass={cs.LG},
      url={https://arxiv.org/abs/2401.18057}, 
}
```

## Get Started
To run the code, the following packages are required to be installed:



```
python==3.7.10
numpy==1.19.5
torch==1.10.2
scikit-learn==0.24.2
matplotlib==3.3.4
nni==2.6.1
```

## Prepare Datasets
We use 128 UCR datasets and 30 UEA datasets to do the classification task, you can download all of the data on these two websites:

[https://www.cs.ucr.edu/%7Eeamonn/time_series_data_2018/](https://www.cs.ucr.edu/%7Eeamonn/time_series_data_2018/)

[https://www.timeseriesclassification.com](https://www.timeseriesclassification.com)


## Usage

## Train RankSCL method

1. Install the datasets and create a dataset file. 
2. Change the dataset path in ```RankSCL/utils/load_data.py```.
3. Enter ```RankSCL``` file and run the ```scripts``` file by using ```bash``` or use the following command:

```
python ../main.py --path UCR --cuda --device 2 --model FCN  --distance EU --aug_positives 5 --seed 1 --lr 0.0001 --weight_decay 0.0008 --epochs_up 300 --epochs_down 100 --loss rank --dataset Earthquakes --batchsize 8

```
You can edit the encoder architecture here by changing the parameter ``` model``` and all of the other parameters.
You can edit the ```sh``` file depending on your needs to train. 




## Experiment Results

The full experiments are shown here, for 128 UCR datasets(ACC&Precision):


| Dataset                    | RankSCL ACC | RankSCL Prec. | InfoTS ACC | InfoTS Prec. | TS2Vec ACC | TS2Vec Prec. | T-Loss ACC | T-Loss Prec. | DTW ACC | DTW Prec. | TS-TCC ACC | TS-TCC Prec. | TNC ACC | TNC Prec. |
|----------------------------|-------------|---------------|------------|--------------|------------|--------------|------------|--------------|---------|-----------|------------|--------------|---------|-----------|
| Adiac                      | **0.822**   | **0.821**     | 0.753      | 0.768        | 0.765      | 0.772        | 0.645      | 0.642        | 0.573   | 0.624     | 0.241      | 0.148        | 0.068   | 0.029     |
| ACSF1                      | **0.896**   | **0.906**     | 0.772      | 0.797        | 0.870      | 0.883        | **0.896**  | 0.896        | 0.590   | 0.630     | 0.438      | 0.367        | 0.166   | 0.065     |
| ArrowHead                  | **0.848**   | **0.853**     | 0.824      | 0.832        | 0.834      | 0.833        | 0.804      | 0.813        | 0.709   | 0.705     | 0.694      | 0.554        | 0.339   | 0.113     |
| Beef                       | **0.747**   | **0.785**     | 0.738      | 0.773        | 0.720      | 0.781        | 0.660      | 0.660        | 0.567   | 0.639     | 0.654      | 0.471        | 0.240   | 0.172     |
| BeetleFly                  | **0.940**   | **0.947**     | 0.826      | 0.871        | 0.890      | 0.916        | 0.880      | 0.560        | 0.700   | 0.738     | 0.561      | 0.673        | 0.580   | 0.540     |
| BirdChicken                | **0.900**   | **0.917**     | 0.724      | 0.732        | 0.870      | 0.887        | 0.810      | 0.850        | 0.600   | 0.600     | 0.717      | 0.682        | 0.540   | 0.402     |
| Car                        | **0.847**   | **0.853**     | 0.770      | 0.765        | 0.730      | 0.744        | 0.713      | 0.718        | 0.517   | 0.546     | 0.728      | 0.667        | 0.217   | 0.062     |
| CBF                        | **0.997**   | **0.997**     | 0.991      | 0.992        | 0.996      | 0.996        | 0.987      | 0.987        | **0.997**| **0.997** | 0.822      | 0.830        | 0.384   | 0.352     |
| ChlorineConcentration      | 0.817       | 0.799         | 0.779      | 0.750        | **0.823**  | **0.804**    | 0.724      | 0.682        | 0.548   | 0.484     | 0.565      | 0.306        | 0.549   | 0.447     |
| CinCECGTorso               | 0.720       | 0.741         | 0.803      | 0.816        | 0.798      | 0.814        | 0.682      | 0.682        | 0.498   | 0.534     | **0.858**  | **0.834**    | 0.272   | 0.160     |
| Coffee                     | **1.000**   | **1.000**     | **1.000**  | **1.000**    | **1.000**  | **1.000**    | **1.000**  | **1.000**    | 0.929   | 0.941     | 0.881      | 0.825        | 0.507   | 0.254     |
| Computers                  | **0.763**   | **0.764**     | 0.655      | 0.669        | 0.652      | 0.653        | 0.669      | 0.577        | 0.684   | 0.687     | 0.562      | 0.513        | 0.552   | 0.506     |
| CricketX                   | **0.792**   | 0.799         | 0.699      | 0.715        | 0.789      | **0.809**    | 0.774      | 0.778        | 0.744   | 0.767     | 0.662      | 0.573        | 0.138   | 0.081     |
| CricketY                   | **0.789**   | **0.793**     | 0.693      | 0.711        | 0.762      | 0.775        | 0.733      | 0.733        | 0.685   | 0.718     | 0.637      | 0.534        | 0.175   | 0.117     |
| CricketZ                   | **0.823**   | **0.823**     | 0.725      | 0.731        | 0.800      | 0.800        | 0.760      | 0.755        | 0.754   | 0.763     | 0.680      | 0.585        | 0.112   | 0.094     |
| DiatomSizeReduction        | 0.924       | 0.946         | **0.982**  | **0.979**    | 0.950      | 0.970        | 0.976      | 0.948        | 0.709   | 0.616     | 0.665      | 0.546        | 0.311   | 0.101     |
| DistalPhalanxOutlineCorrect| **0.766**   | 0.760         | 0.759      | 0.762        | 0.764      | 0.767        | **0.766**  | **0.781**    | 0.732   | 0.754     | 0.649      | 0.552        | 0.595   | 0.414     |
| DistalPhalanxOutlineAgeGroup|0.741       | 0.730         | 0.737      | **0.777**    | 0.716      | 0.745        | 0.727      | 0.696        | **0.748** | 0.754   | 0.707      | 0.535        | 0.643   | 0.436     |
| DistalPhalanxTW            | **0.692**   | **0.543**     | 0.670      | 0.497        | 0.682      | 0.507        | 0.668      | 0.515        | 0.662   | 0.498     | 0.689      | 0.490        | 0.579   | 0.205     |
| Earthquakes                | 0.732       | 0.601         | 0.749      | 0.475        | 0.748      | 0.374        | 0.748      | 0.500        | 0.748   | 0.628     | 0.736      | 0.615        | **0.754**| **0.690** |
| ECG200                     | **0.920**   | **0.917**     | 0.864      | 0.857        | 0.908      | 0.891        | 0.862      | 0.873        | 0.790   | 0.781     | 0.841      | 0.805        | 0.684   | 0.633     |
| ECG5000                    | **0.942**   | 0.680         | 0.939      | 0.733        | 0.938      | 0.699        | 0.935      | 0.514        | 0.938   | 0.655     | 0.941      | **0.874**    | 0.873   | 0.391     |
| ECGFiveDays                | 0.997       | 0.997         | 0.987      | 0.987        | **1.000**  | **1.000**    | 0.999      | 0.975        | 0.598   | 0.683     | 0.834      | 0.844        | 0.547   | 0.427     |
| ElectricDevices            | 0.691       | 0.652         | 0.677      | 0.648        | 0.710      | **0.678**    | **0.714**  | 0.620        | 0.610   | 0.578     | 0.672      | 0.554        | 0.443   | 0.342     |
| FaceAll                    | 0.775       | 0.812         | 0.753      | 0.792        | 0.783      | 0.814        | 0.758      | **0.854**    | **0.808**| 0.811     | 0.765      | 0.703        | 0.239   | 0.257     |
| FaceFour                   | 0.832       | 0.833         | 0.764      | 0.777        | 0.886      | 0.906        | 0.805      | 0.827        | 0.682   | 0.746     | **0.932**  | **0.913**    | 0.359   | 0.260     |
| FacesUCR                   | 0.914       | 0.919         | 0.848      | 0.851        | **0.932**  | **0.934**    | 0.875      | 0.826        | 0.886   | 0.880     | 0.893      | 0.837        | 0.295   | 0.158     |
| FiftyWords                 | 0.727       | 0.653         | 0.758      | 0.678        | **0.775**  | **0.734**    | 0.732      | 0.578        | 0.664   | 0.561     | 0.710      | 0.564        | 0.148   | 0.016     |
| Fish                       | **0.941**   | **0.954**     | 0.829      | 0.845        | 0.930      | 0.934        | 0.844      | 0.847        | 0.794   | 0.793     | 0.746      | 0.693        | 0.155   | 0.042     |
| FordA                      | **0.956**   | **0.956**     | 0.878      | 0.879        | 0.940      | 0.940        | 0.931      | 0.910        | 0.594   | 0.595     | 0.912      | 0.906        | 0.524   | 0.522     |
| FordB                      | **0.828**   | **0.829**     | 0.730      | 0.730        | 0.802      | 0.806        | 0.794      | 0.773        | 0.654   | 0.661     | 0.763      | 0.757        | 0.506   | 0.505     |
| GunPoint                   | **0.995**   | **0.995**     | 0.975      | 0.975        | 0.983      | 0.983        | 0.976      | 0.943        | 0.827   | 0.829     | 0.879      | 0.884        | 0.513   | 0.506     |
| Ham                        | 0.714       | 0.715         | 0.695      | 0.697        | 0.711      | 0.711        | 0.659      | 0.615        | 0.590   | 0.590     | **0.754**  | **0.726**    | 0.520   | 0.443     |
| HandOutlines               | 0.913       | 0.906         | 0.924      | 0.922        | **0.928**  | **0.931**    | 0.909      | 0.896        | 0.889   | 0.900     | 0.663      | 0.671        | 0.641   | 0.370     |
| Haptics                    | **0.539**   | **0.544**     | 0.499      | 0.508        | 0.526      | 0.534        | 0.451      | 0.446        | 0.406   | 0.437     | 0.367      | 0.297        | 0.213   | 0.176     |
| Herring                    | 0.613       | **0.614**     | **0.621**  | 0.564        | 0.600      | 0.514        | 0.556      | 0.516        | 0.547   | 0.544     | 0.541      | 0.532        | 0.594   | 0.297     |
| InlineSkate                | 0.371       | 0.384         | 0.350      | 0.376        | **0.389**  | **0.426**    | 0.357      | 0.357        | 0.356   | 0.388     | 0.286      | 0.227        | 0.169   | 0.049     |
| InsectWingbeatSound        | 0.615       | 0.614         | 0.630      | **0.634**    | 0.626      | 0.628        | 0.564      | 0.565        | 0.362   | 0.394     | **0.662**  | 0.565        | 0.186   | 0.097     |
| ItalyPowerDemand           | **0.960**   | **0.960**     | 0.957      | 0.957        | 0.958      | 0.959        | 0.946      | 0.901        | 0.946   | 0.946     | 0.940      | 0.935        | 0.746   | 0.783     |
| LargeKitchenAppliances     | **0.912**   | **0.915**     | 0.771      | 0.773        | 0.865      | 0.871        | 0.820      | 0.820        | 0.800   | 0.805     | 0.585      | 0.445        | 0.386   | 0.424     |
| Lightning2                 | 0.830       | 0.833         | 0.743      | 0.781        | **0.852**  | **0.856**    | **0.852**  | 0.799        | 0.820   | 0.855     | 0.709      | 0.712        | 0.577   | 0.454     |
| Lightning7                 | 0.786       | 0.820         | 0.762      | 0.811        | **0.844**  | **0.880**    | 0.784      | 0.760        | 0.726   | 0.852     | 0.768      | 0.689        | 0.260   | 0.159     |
| Mallat                     | **0.962**   | **0.966**     | 0.879      | 0.897        | 0.906      | 0.917        | 0.959      | 0.959        | 0.928   | 0.940     | 0.820      | 0.745        | 0.156   | 0.074     |
| Meat                       | **0.967**   | **0.970**     | 0.920      | 0.930        | 0.903      | 0.923        | 0.910      | 0.910        | 0.933   | 0.944     | 0.313      | 0.281        | 0.333   | 0.111     |
| MedicalImages              | **0.793**   | 0.786         | 0.765      | 0.754        | 0.788      | **0.808**    | 0.762      | 0.714        | 0.709   | 0.694     | 0.690      | 0.501        | 0.513   | 0.118     |
| MiddlePhalanxOutlineCorrect| **0.846**   | **0.846**     | 0.801      | 0.798        | 0.789      | 0.786        | 0.777      | 0.756        | 0.732   | 0.730     | 0.619      | 0.551        | 0.570   | 0.285     |
| MiddlePhalanxOutlineAgeGroup| 0.445      | 0.447         | **0.651**  | **0.874**    | 0.641      | 0.813        | 0.644      | 0.472        | 0.558   | 0.474     | 0.636      | 0.413        | 0.554   | 0.330     |
| MiddlePhalanxTW            | 0.579       | **0.458**     | **0.589**  | 0.441        | 0.586      | 0.425        | 0.574      | 0.417        | 0.552   | 0.350     | 0.576      | 0.308        | 0.500   | 0.178     |
| MoteStrain                 | **0.889**   | **0.888**     | 0.861      | 0.868        | 0.871      | 0.870        | 0.857      | 0.742        | 0.814   | 0.816     | 0.844      | 0.847        | 0.737   | 0.756     |
| NonInvasiveFetalECGThorax1 | **0.951**   | **0.949**     | 0.934      | 0.932        | 0.925      | 0.923        | 0.890      | 0.889        | 0.786   | 0.808     | 0.863      | 0.784        | 0.167   | 0.108     |
| NonInvasiveFetalECGThorax2 | 0.893       | 0.891         | **0.937**  | 0.935        | **0.937**  | **0.936**    | 0.925      | 0.923        | 0.863   | 0.865     | 0.848      | 0.754        | 0.138   | 0.080     |
| OliveOil                   | 0.840       | 0.851         | **0.868**  | **0.909**    | 0.840      | 0.896        | 0.833      | 0.777        | 0.767   | 0.694     | 0.407      | 0.303        | 0.400   | 0.100     |
| OSULeaf                    | **0.926**   | **0.927**     | 0.659      | 0.658        | 0.831      | 0.843        | 0.746      | 0.734        | 0.545   | 0.498     | 0.498      | 0.433        | 0.234   | 0.174     |
| PhalangesOutlinesCorrect   | **0.829**   | **0.826**     | 0.795      | 0.813        | 0.809      | 0.810        | 0.799      | 0.786        | 0.755   | 0.784     | 0.656      | 0.500        | 0.615   | 0.508     |
| Phoneme                    | 0.277       | **0.169**     | 0.198      | 0.089        | **0.307**  | 0.157        | 0.267      | 0.115        | 0.294   | 0.144     | 0.182      | 0.135        | 0.111   | 0.017     |
| Plane                      | 0.996       | 0.996         | 0.996      | 0.997        | 0.986      | 0.988        | 0.988      | 0.988        | **1.000**| **1.000** | 0.964      | 0.939        | 0.263   | 0.189     |
| ProximalPhalanxOutlineCorrect| **0.893** | 0.888         | 0.874      | **0.890**    | 0.882      | 0.883        | 0.867      | 0.838        | 0.832   | 0.849     | 0.711      | 0.583        | 0.692   | 0.537     |
| ProximalPhalanxOutlineAgeGroup|0.843      | 0.742         | **0.859**  | **0.769**    | 0.845      | 0.735        | 0.848      | 0.743        | 0.824   | 0.709     | 0.645      | 0.561        | 0.855   | 0.637     |
| ProximalPhalanxTW          | 0.776       | 0.547         | **0.819**  | **0.603**    | 0.793      | 0.570        | 0.801      | 0.550        | 0.761   | 0.499     | 0.643      | 0.394        | 0.674   | 0.235     |
| RefrigerationDevices       | 0.554       | 0.575         | 0.566      | 0.596        | **0.596**  | **0.627**    | 0.524      | 0.525        | 0.475   | 0.489     | 0.452      | 0.382        | 0.346   | 0.332     |
| ScreenType                 | **0.583**   | **0.589**     | 0.447      | 0.447        | 0.411      | 0.389        | 0.421      | 0.424        | 0.427   | 0.440     | 0.381      | 0.374        | 0.337   | 0.320     |
| ShapeletSim                | 0.949       | 0.949         | 0.556      | 0.557        | **0.990**  | **0.990**    | 0.759      | 0.532        | 0.639   | 0.640     | 0.524      | 0.481        | 0.509   | 0.508     |
| ShapesAll                  | **0.908**   | **0.921**     | 0.789      | 0.799        | 0.896      | 0.909        | 0.851      | 0.852        | 0.708   | 0.687     | 0.718      | 0.563        | 0.072   | 0.018     |
| SmallKitchenAppliances     | **0.813**   | **0.822**     | 0.738      | 0.735        | 0.727      | 0.724        | 0.686      | 0.686        | 0.688   | 0.684     | 0.610      | 0.441        | 0.513   | 0.435     |
| SonyAIBORobotSurface1      | 0.831       | 0.858         | 0.864      | 0.877        | **0.885**  | 0.892        | 0.835      | **0.973**    | 0.617   | 0.764     | 0.557      | 0.575        | 0.448   | 0.364     |
| SonyAIBORobotSurface2      | **0.935**   | **0.929**     | 0.860      | 0.852        | 0.870      | 0.862        | 0.920      | 0.813        | 0.803   | 0.801     | 0.813      | 0.800        | 0.681   | 0.663     |
| StarLightCurves            | **0.974**   | **0.962**     | 0.962      | 0.943        | 0.968      | 0.952        | 0.961      | 0.947        | 0.914   | 0.871     | 0.939      | 0.901        | 0.818   | 0.614     |
| Strawberry                 | **0.972**   | **0.966**     | 0.960      | 0.952        | 0.963      | 0.955        | 0.945      | 0.931        | 0.919   | 0.906     | 0.897      | 0.820        | 0.644   | 0.336     |
| SwedishLeaf                | **0.955**   | **0.956**     | 0.911      | 0.913        | 0.939      | 0.940        | 0.926      | 0.927        | 0.779   | 0.787     | 0.884      | 0.813        | 0.231   | 0.195     |
| Symbols                    | 0.859       | 0.875         | 0.955      | 0.956        | **0.971**  | **0.972**    | 0.958      | 0.958        | 0.929   | 0.943     | 0.834      | 0.775        | 0.262   | 0.189     |
| SyntheticControl           | **0.995**   | **0.995**     | **0.995**  | **0.995**    | **0.995**  | **0.995**    | 0.984      | 0.984        | 0.983   | 0.984     | 0.990      | 0.969        | 0.695   | 0.707     |
| ToeSegmentation1           | **0.961**   | **0.962**     | 0.808      | 0.818        | 0.914      | 0.918        | 0.943      | 0.790        | 0.741   | 0.787     | 0.576      | 0.514        | 0.485   | 0.370     |
| ToeSegmentation2           | 0.780       | 0.714         | 0.816      | 0.718        | **0.868**  | **0.790**    | 0.852      | 0.762        | 0.815   | 0.701     | 0.574      | 0.551        | 0.527   | 0.422     |
| Trace                      | **1.000**   | **1.000**     | **1.000**  | **1.000**    | 0.998      | 0.998        | **1.000**  | **1.000**    | 0.963   | **1.000** | 0.702      | 0.616        | 0.350   | 0.248     |
| TwoLeadECG                 | **0.996**   | **0.996**     | 0.924      | 0.932        | 0.979      | 0.980        | 0.991      | 0.922        | 0.852   | 0.883     | 0.724      | 0.730        | 0.537   | 0.577     |
| TwoPatterns                | **1.000**   | **1.000**     | 0.999      | 0.999        | **1.000**  | **1.000**    | **1.000**  | **1.000**    | **1.000**| **1.000** | 0.999      | 0.999        | 0.402   | 0.372     |
| UWaveGestureLibraryX       | **0.804**   | **0.801**     | **0.804**  | 0.796        | **0.804**  | 0.799        | 0.802      | **0.801**    | 0.736   | 0.708     | 0.767      | 0.703        | 0.289   | 0.179     |
| UWaveGestureLibraryY       | **0.724**   | 0.724         | 0.722      | 0.720        | 0.723      | 0.722        | **0.724**  | **0.727**    | 0.632   | 0.626     | 0.640      | 0.551        | 0.405   | 0.322     |
| UWaveGestureLibraryZ       | 0.756       | 0.749         | 0.741      | 0.732        | **0.759**  | **0.752**    | 0.748      | 0.751        | 0.671   | 0.659     | 0.683      | 0.598        | 0.336   | 0.228     |
| UWaveGestureLibraryAll     | 0.836       | 0.838         | **0.954**  | **0.954**    | 0.934      | 0.934        | 0.908      | 0.909        | 0.179   | 0.181     | 0.939      | 0.914        | 0.316   | 0.269     |
| Wafer                      | **0.996**   | 0.990         | 0.995      | **0.991**    | **0.996**  | **0.991**    | 0.992      | 0.987        | 0.975   | 0.975     | 0.994      | 0.985        | 0.895   | 0.716     |
| Wine                       | 0.789       | 0.790         | 0.813      | **0.820**    | 0.763      | 0.713        | **0.830**  | 0.815        | 0.574   | 0.575     | 0.496      | 0.473        | 0.500   | 0.300     |
| WordSynonyms               | 0.663       | 0.616         | 0.654      | 0.581        | **0.690**  | **0.659**    | 0.674      | 0.500        | 0.596   | 0.575     | 0.608      | 0.430        | 0.237   | 0.028     |
| Worms                      | **0.821**   | **0.834**     | 0.646      | 0.702        | 0.719      | 0.751        | 0.709      | 0.612        | 0.403   | 0.381     | 0.537      | 0.417        | 0.424   | 0.131     |
| WormsTwoClass              | 0.753       | **0.782**     | 0.693      | 0.692        | 0.784      | 0.781        | **0.808**  | 0.726        | 0.532   | 0.537     | 0.583      | 0.532        | 0.561   | 0.434     |
| Yoga                       | **0.895**   | **0.895**     | 0.829      | 0.829        | 0.881      | 0.882        | 0.871      | 0.836        | 0.785   | 0.785     | 0.733      | 0.732        | 0.516   | 0.554     |
| AllGestureWiimoteX         | 0.752       | 0.761         | 0.109      | 0.029        | **0.785**  | **0.788**    | 0.784      | 0.785        | 0.679   | 0.687     | 0.514      | 0.325        | 0.112   | 0.017     |
| AllGestureWiimoteY         | 0.774       | 0.774         | 0.148      | 0.085        | 0.777      | 0.779        | **0.789**  | **0.789**    | 0.676   | 0.694     | 0.546      | 0.335        | 0.108   | 0.022     |
| AllGestureWiimoteZ         | **0.774**   | **0.782**     | 0.132      | 0.058        | 0.759      | 0.761        | 0.754      | 0.756        | 0.649   | 0.662     | 0.548      | 0.344        | 0.125   | 0.032     |
| BME                        | 0.991       | 0.991         | **0.998**  | **0.998**    | 0.980      | 0.981        | 0.971      | 0.971        | 0.847   | 0.844     | 0.880      | 0.779        | 0.467   | 0.449     |
| Chinatown                  | 0.937       | 0.906         | **0.975**  | **0.960**    | 0.972      | 0.955        | 0.943      | 0.909        | 0.971   | 0.952     | 0.855      | 0.743        | 0.717   | 0.575     |
| Crop                       | **0.775**   | **0.777**     | 0.754      | 0.754        | 0.753      | 0.752        | 0.731      | 0.732        | 0.659   | 0.668     | 0.634      | 0.448        | 0.370   | 0.350     |
| EOGHorizontalSignal        | **0.677**   | **0.710**     | 0.512      | 0.559        | 0.537      | 0.589        | 0.532      | 0.537        | 0.434   | 0.486     | 0.428      | 0.348        | 0.188   | 0.105     |
| EOGVerticalSignal          | 0.461       | 0.496         | 0.397      | 0.437        | **0.484**  | **0.508**    | 0.453      | 0.457        | 0.436   | 0.448     | 0.379      | 0.286        | 0.173   | 0.080     |
| EthanolLevel               | **0.808**   | **0.815**     | 0.582      | 0.583        | 0.474      | 0.470        | 0.315      | 0.316        | 0.280   | 0.273     | 0.322      | 0.265        | 0.253   | 0.125     |
| FreezerRegularTrain        | **0.994**   | **0.994**     | 0.987      | 0.988        | 0.983      | 0.984        | 0.979      | 0.961        | 0.839   | 0.839     | 0.894      | 0.715        | 0.705   | 0.719     |
| FreezerSmallTrain          | 0.781       | 0.783         | **0.901**  | **0.904**    | 0.870      | 0.870        | 0.883      | 0.864        | 0.760   | 0.761     | 0.692      | 0.543        | 0.593   | 0.624     |
| Fungi                      | 0.855       | 0.897         | 0.887      | 0.936        | 0.938      | 0.952        | **0.990**  | **0.995**    | 0.177   | 0.032     | 0.444      | 0.375        | 0.084   | 0.009     |
| GestureMidAirD1            | **0.726**   | **0.752**     | 0.091      | 0.029        | 0.623      | 0.678        | 0.562      | 0.565        | 0.438   | 0.466     | 0.624      | 0.490        | 0.052   | 0.004     |
| GestureMidAirD2            | **0.605**   | **0.645**     | 0.065      | 0.032        | 0.534      | 0.556        | 0.482      | 0.485        | 0.362   | 0.368     | 0.512      | 0.373        | 0.054   | 0.004     |
| GestureMidAirD3            | 0.266       | 0.270         | 0.075      | 0.033        | 0.312      | **0.315**    | 0.277      | 0.271        | 0.169   | 0.099     | **0.330**  | 0.231        | 0.051   | 0.020     |
| GesturePebbleZ1            | 0.865       | 0.879         | 0.228      | 0.149        | 0.852      | 0.878        | **0.884**  | **0.880**    | 0.657   | 0.692     | 0.752      | 0.728        | 0.161   | 0.027     |
| GesturePebbleZ2            | 0.851       | **0.860**     | 0.209      | 0.098        | **0.857**  | **0.860**    | 0.843      | 0.837        | 0.582   | 0.653     | 0.727      | 0.700        | 0.155   | 0.037     |
| GunPointAgeSpan            | **0.996**   | **0.996**     | 0.967      | 0.969        | 0.980      | 0.980        | 0.983      | 0.974        | 0.994   | 0.994     | 0.804      | 0.755        | 0.558   | 0.536     |
| GunPointMaleVersusFemale   | 0.999       | 0.999         | 0.999      | 0.999        | **1.000**  | **1.000**    | **1.000**  | 0.997        | 0.968   | 0.968     | 0.974      | 0.919        | 0.728   | 0.782     |
| GunPointOldVersusYoung     | **1.000**   | **1.000**     | **1.000**  | **1.000**    | **1.000**  | **1.000**    | **1.000**  | **1.000**    | **1.000**| **1.000** | 0.999      | 0.998        | 0.840   | 0.878     |
| HouseTwenty                | **0.943**   | **0.941**     | 0.846      | 0.851        | 0.902      | 0.910        | 0.933      | 0.843        | 0.882   | 0.883     | 0.804      | 0.620        | 0.578   | 0.654     |
| InsectEPGRegularTrain      | **1.000**   | **1.000**     | **1.000**  | **1.000**    | **1.000**  | **1.000**    | **1.000**  | **1.000**    | **1.000**| **1.000** | **1.000**  | **1.000**    | 0.831   | 0.579     |
| InsectEPGSmallTrain        | **1.000**   | **1.000**     | **1.000**  | **1.000**    | **1.000**  | **1.000**    | **1.000**  | **1.000**    | **1.000**| **1.000** | 0.916      | 0.911        | 0.714   | 0.548     |
| MelbournePedestrian        | **0.958**   | **0.958**     | 0.928      | 0.933        | 0.955      | 0.955        | 0.938      | 0.938        | 0.831   | 0.849     | 0.807      | 0.672        | 0.253   | 0.200     |
| MixedShapesRegularTrain    | **0.951**   | **0.947**     | 0.916      | 0.915        | 0.919      | 0.919        | 0.922      | 0.923        | 0.823   | 0.819     | 0.851      | 0.670        | 0.254   | 0.278     |
| MixedShapesSmallTrain      | **0.878**   | 0.872         | 0.831      | 0.839        | 0.852      | 0.848        | 0.872      | **0.877**    | 0.739   | 0.748     | 0.789      | 0.602        | 0.240   | 0.239     |
| PickupGestureWiimoteZ      | 0.800       | 0.836         | 0.142      | 0.072        | **0.840**  | **0.868**    | 0.804      | 0.808        | 0.680   | 0.687     | 0.739      | 0.610        | 0.140   | 0.028     |
| PigAirwayPressure          | 0.533       | 0.577         | 0.205      | 0.258        | **0.626**  | **0.656**    | 0.465      | 0.464        | 0.053   | 0.041     | 0.088      | 0.073        | 0.031   | 0.002     |
| PigArtPressure             | **0.978**   | **0.983**     | 0.444      | 0.463        | 0.964      | 0.972        | 0.924      | 0.922        | 0.322   | 0.278     | 0.164      | 0.143        | 0.040   | 0.008     |
| PigCVP                     | 0.797       | **0.834**     | 0.192      | 0.196        | **0.811**  | 0.821        | 0.740      | 0.738        | 0.202   | 0.198     | 0.119      | 0.102        | 0.040   | 0.005     |
| PLAID                      | 0.495       | 0.584         | 0.087      | 0.084        | 0.544      | 0.590        | 0.636      | 0.556        | **0.892**| **0.909** | 0.324      | 0.276        | 0.205   | 0.048     |
| PowerCons                  | 0.951       | 0.952         | 0.984      | 0.984        | 0.964      | 0.965        | 0.931      | 0.871        | 0.856   | 0.857     | **0.997**  | **0.996**    | 0.673   | 0.691     |
| Rock                       | 0.428       | 0.478         | 0.590      | 0.513        | **0.712**  | **0.691**    | 0.576      | 0.639        | 0.440   | 0.379     | 0.514      | 0.393        | 0.288   | 0.151     |
| SemgHandGenderCh2          | 0.665       | 0.749         | 0.870      | 0.856        | **0.956**  | **0.949**    | 0.908      | 0.861        | 0.912   | 0.907     | 0.919      | 0.805        | 0.588   | 0.640     |
| SemgHandMovementCh2        | 0.720       | 0.723         | 0.667      | 0.674        | **0.870**  | **0.873**    | 0.783      | 0.784        | 0.764   | 0.780     | 0.670      | 0.443        | 0.290   | 0.278     |
| SemgHandSubjectCh2         | 0.876       | 0.883         | 0.852      | 0.854        | **0.948**  | **0.949**    | 0.859      | 0.861        | 0.849   | 0.855     | 0.883      | 0.715        | 0.439   | 0.413     |
| ShakeGestureWiimoteZ       | 0.880       | 0.901         | 0.182      | 0.077        | 0.924      | **0.939**    | **0.928**  | 0.929        | 0.820   | 0.779     | 0.807      | 0.779        | 0.104   | 0.015     |
| SmoothSubspace             | 0.975       | 0.975         | 0.824      | 0.805        | **0.976**  | **0.976**    | 0.943      | 0.943        | 0.860   | 0.862     | 0.926      | 0.768        | 0.788   | 0.788     |
| UMD                        | 0.990       | 0.990         | 0.990      | 0.991        | **0.994**  | **0.994**    | 0.992      | 0.992        | 0.854   | 0.854     | 0.932      | 0.878        | 0.407   | 0.236     |
| DodgerLoopDay              | 0.537       | 0.581         | **0.556**  | **0.587**    | 0.495      | 0.540        | --         | --           | 0.362   | 0.453     | 0.555      | 0.376        | 0.200   | 0.133     |
| DodgerLoopGame             | 0.803       | 0.803         | 0.777      | 0.784        | 0.813      | 0.818        | --         | --           | **0.862**| **0.896** | 0.750      | 0.750        | 0.571   | 0.424     |
| DodgerLoopWeekend          | 0.896       | 0.858         | **0.972**  | **0.960**    | 0.952      | 0.936        | --         | --           | 0.949   | 0.931     | 0.910      | 0.765        | 0.717   | 0.441     |
| AVG                        | 0.821       | **0.817**     | 0.733      | 0.723        | **0.822**  | 0.816        | 0.782      | 0.750        | 0.699   | 0.692     | 0.685      | 0.603        | 0.406   | 0.305     |

30 UEA dataset results: 
| Dataset                    | RankSCL ACC | RankSCL Prec. | InfoTS ACC | InfoTS Prec. | TS2Vec ACC | TS2Vec Prec. | T-Loss ACC | T-Loss Prec. | DTW ACC | DTW Prec. | TS-TCC ACC | TS-TCC Prec. | TNC ACC | TNC Prec. |
|----------------------------|-------------|---------------|------------|--------------|------------|--------------|------------|--------------|---------|-----------|------------|--------------|---------|-----------|
| ArticularyWordRecognition  | 0.977       | 0.978        | 0.982      | 0.983        | 0.981      | 0.984        | 0.961      | 0.961        | **0.983** | **0.985** | 0.927      | 0.869        | 0.579   | 0.601     |
| AtrialFibrillation         | 0.293       | 0.309        | 0.141      | 0.121        | 0.240      | 0.395        | 0.133      | 0.133        | **0.467** | **0.435** | 0.304      | 0.228        | 0.281   | 0.165     |
| BasicMotions               | **1.000**   | **1.000**    | 0.985      | 0.986        | 0.975      | 0.977        | 0.955      | 0.955        | 0.775   | 0.882     | 0.945      | 0.903        | 0.500   | 0.523     |
| CharacterTrajectories      | **0.996**   | **0.995**    | 0.682      | 0.808        | 0.993      | 0.993        | 0.060      | 0.050        | 0.982   | 0.981     | 0.979      | 0.961        | 0.197   | 0.158     |
| Cricket                    | 0.986       | 0.987        | 0.971      | 0.974        | 0.972      | 0.975        | 0.989      | 0.989        | **1.000** | **1.000** | 0.778      | 0.721        | 0.553   | 0.485     |
| DuckDuckGeese              | **0.604**   | **0.642**    | 0.493      | 0.543        | 0.496      | 0.495        | 0.580      | 0.579        | 0.340   | 0.296     | 0.331      | 0.295        | 0.356   | 0.369     |
| EigenWorms                 | 0.727       | 0.786        | 0.660      | 0.661        | 0.841      | **0.791**    | **0.846**  | 0.790        | 0.588   | 0.474     | 0.311      | 0.320        | 0.369   | 0.108     |
| Epilepsy                   | 0.975       | 0.977        | 0.959      | 0.958        | 0.963      | 0.961        | **0.978**  | **0.979**    | 0.935   | 0.938     | 0.859      | 0.815        | 0.317   | 0.284     |
| ERing                      | 0.913       | 0.915        | 0.932      | **0.937**    | 0.850      | 0.870        | 0.838      | 0.837        | **0.933** | 0.935     | 0.884      | 0.850        | 0.501   | 0.519     |
| EthanolConcentration       | 0.304       | **0.309**    | 0.258      | 0.258        | 0.282      | 0.285        | 0.234      | 0.231        | 0.289   | 0.302     | 0.291      | 0.283        | **0.308** | 0.199     |
| FaceDetection              | **0.637**   | **0.638**    | 0.520      | 0.520        | 0.512      | 0.512        | 0.518      | 0.505        | 0.534   | 0.534     | 0.540      | 0.506        | 0.518   | 0.523     |
| FingerMovements            | 0.528       | 0.529        | 0.483      | 0.484        | 0.480      | 0.480        | **0.536**  | 0.533        | 0.620   | 0.620     | 0.476      | 0.458        | 0.476   | 0.473     |
| HandMovementDirection      | 0.322       | 0.333        | 0.359      | 0.362        | 0.308      | 0.340        | 0.305      | 0.334        | 0.189   | 0.268     | **0.434**  | **0.373**    | 0.286   | 0.247     |
| Handwriting                | **0.566**   | **0.560**    | 0.394      | 0.418        | 0.520      | 0.536        | 0.425      | 0.438        | 0.500   | 0.548     | 0.297      | 0.204        | 0.061   | 0.029     |
| Heartbeat                  | 0.740       | 0.678        | **0.745**  | 0.710        | 0.711      | 0.675        | 0.713      | 0.647        | 0.722   | 0.630     | 0.724      | **0.717**    | 0.694   | 0.589     |
| JapaneseVowels             | 0.980       | 0.977        | **0.988**  | **0.988**    | 0.985      | 0.987        | 0.080      | 0.110        | 0.968   | 0.968     | 0.858      | 0.785        | 0.189   | 0.179     |
| Libras                     | **0.914**   | **0.923**    | 0.849      | 0.856        | 0.851      | 0.860        | 0.868      | 0.868        | 0.867   | 0.868     | 0.701      | 0.641        | 0.250   | 0.202     |
| LSST                       | 0.164       | 0.201        | **0.566**  | **0.454**    | 0.543      | 0.416        | 0.528      | 0.325        | 0.559   | 0.421     | 0.366      | 0.379        | 0.360   | 0.216     |
| MotorImagery               | **0.550**   | **0.557**    | 0.472      | 0.472        | 0.498      | 0.249        | 0.526      | 0.500        | 0.490   | 0.490     | 0.526      | 0.418        | 0.534   | 0.536     |
| NATOPS                     | **0.927**   | **0.928**    | 0.922      | 0.924        | 0.916      | 0.916        | 0.912      | 0.912        | 0.878   | 0.877     | 0.729      | 0.631        | 0.301   | 0.341     |
| PEMS-SF                    | **0.881**   | **0.886**    | 0.705      | 0.714        | 0.684      | 0.692        | 0.635      | 0.638        | 0.555   | 0.564     | 0.676      | 0.570        | 0.301   | 0.302     |
| PenDigits                  | 0.986       | 0.987        | 0.987      | 0.987        | **0.989**  | **0.989**    | 0.986      | 0.986        | 0.979   | 0.979     | 0.910      | 0.871        | --      | --        |
| PhonemeSpectra             | **0.271**   | **0.271**    | 0.209      | 0.209        | 0.234      | 0.233        | 0.231      | 0.232        | 0.164   | 0.177     | 0.155      | 0.140        | 0.065   | 0.050     |
| RacketSports               | **0.881**   | **0.891**    | 0.832      | 0.845        | 0.850      | 0.869        | 0.810      | 0.824        | 0.822   | 0.838     | 0.794      | 0.753        | 0.408   | 0.423     |
| SelfRegulationSCP1         | 0.862       | 0.867        | **0.867**  | **0.870**    | 0.786      | 0.815        | 0.832      | 0.866        | 0.833   | 0.850     | 0.862      | 0.850        | 0.627   | 0.666     |
| SelfRegulationSCP2         | 0.549       | 0.549        | 0.536      | 0.539        | **0.560**  | **0.560**    | 0.541      | 0.525        | 0.517   | 0.517     | 0.504      | 0.461        | 0.518   | 0.517     |
| SpokenArabicDigits         | **0.989**   | **0.989**    | 0.915      | 0.921        | 0.988      | 0.988        | 0.100      | 0.100        | 0.980   | 0.981     | 0.959      | 0.941        | 0.123   | 0.060     |
| StandWalkJump              | **0.533**   | **0.529**    | 0.403      | 0.400        | 0.480      | 0.418        | 0.320      | 0.320        | 0.267   | 0.103     | 0.379      | 0.357        | 0.320   | 0.227     |
| UWaveGestureLibrary        | 0.873       | 0.874        | 0.780      | 0.780        | **0.898**  | 0.901        | 0.893      | 0.892        | 0.897   | **0.903** | 0.755      | 0.650        | 0.351   | 0.328     |
| InsectWingbeat             | **0.518**   | **0.512**    | 0.464      | 0.468        | 0.464      | 0.460        | 0.100      | 0.100        | --      | --        | 0.253      | 0.225        | --      | --        |
| **AVG**                    | **0.715**   | **0.719**    | 0.669      | 0.672        | 0.695      | 0.687        | 0.581      | 0.572        | 0.654   | 0.645     | 0.617      | 0.573        | 0.345   | 0.311     |





